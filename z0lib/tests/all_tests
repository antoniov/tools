#! /bin/bash
# -*- coding: utf-8 -*-

if [ -f ./z0librc ]; then
. ./z0librc
  FINAL=./optargs
  TESTDIR=./tests
  OK=$(_install_z0librc "-n")
elif [ -f ../z0librc ]; then
. ../z0librc
  FINAL=../optargs
  TESTDIR=.
  CWD=$PWD
  cd ..
  OK=$(_install_z0librc "-n")
  cd $CWD
fi
if [ "$OK" != "cp ./z0librc /etc/z0librc" ]; then
  echo "Invalid library to test"
  exit 1
fi

$TESTDIR/test_parseoptargs
sts=$?
if [ $sts -eq 0 ]; then
  $TESTDIR/test_parsewhich
  sts=$?
fi
if [ $sts -eq 0 ]; then
  $FINAL -p $PWD "Test" "Success!"
else
  echo "Test failed!"
fi
exit $sts
